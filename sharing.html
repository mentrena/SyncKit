<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<title data-react-helmet="true">Sharing | SyncKit</title><meta data-react-helmet="true" property="og:url" content="https://mentrena.github.io/SyncKit/sharing"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Sharing | SyncKit"><meta data-react-helmet="true" name="description" content="Requirements"><meta data-react-helmet="true" property="og:description" content="Requirements"><link data-react-helmet="true" rel="shortcut icon" href="/SyncKit/img/favicon2.ico"><link data-react-helmet="true" rel="canonical" href="https://mentrena.github.io/SyncKit/sharing"><link data-react-helmet="true" rel="alternate" href="https://mentrena.github.io/SyncKit/sharing" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://mentrena.github.io/SyncKit/sharing" hreflang="x-default"><link rel="stylesheet" href="/SyncKit/assets/css/styles.fe20cb5e.css">
<link rel="preload" href="/SyncKit/assets/js/runtime~main.0680bf2b.js" as="script">
<link rel="preload" href="/SyncKit/assets/js/main.41bd0433.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/SyncKit/"><img src="/SyncKit/img/SyncKit.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/SyncKit/img/SyncKit.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">SyncKit</b></a><a class="navbar__item navbar__link navbar__link--active" href="/SyncKit/">Docs</a><a class="navbar__item navbar__link" href="/SyncKit/api/core/CloudKitSynchronizer">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mentrena/SyncKit" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/SyncKit/"><img src="/SyncKit/img/SyncKit.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/SyncKit/img/SyncKit.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">SyncKit</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/SyncKit/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/SyncKit/api/core/CloudKitSynchronizer">API</a></li><li class="menu__list-item"><a href="https://github.com/mentrena/SyncKit" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/SyncKit/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/SyncKit/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/SyncKit/example">Example app</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Using SyncKit</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/SyncKit/overview">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Core Data</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/SyncKit/coredata">SyncKit for Core Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/SyncKit/migrating">Migrating from SyncKit 0.3.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Realm</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/SyncKit/realm">SyncKit for Realm</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/SyncKit/configuration">Configuration</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/SyncKit/sharing">Sharing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advanced</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/SyncKit/architecture">Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/SyncKit/faq">FAQ</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">Sharing</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="requirements"></a>Requirements<a class="hash-link" href="#requirements" title="Direct link to heading">#</a></h2><p>Your application must support sharing, make sure your Info.plist file has <code>CKSharingSupported = YES</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configuring-records-for-sharing"></a>Configuring records for sharing<a class="hash-link" href="#configuring-records-for-sharing" title="Direct link to heading">#</a></h2><p>Your model classes can conform to <code>ParentKey</code> and implement its <code>static func parentKey() -&gt; String</code> to return the name of the property pointing at the parent object. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">class Company: Object {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    let employees = LinkingObjects(fromType: Employee.self, property: &quot;company&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class Employee: Object, ParentKey {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @objc dynamic var company: Company?</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    let addresses = LinkingObjects(fromType: Address.self, property: &quot;employee&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    static func parentKey() -&gt; String {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return &quot;company&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class Address: Object, ParentKey {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @objc dynamic var employee: Employee?</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    static func parentKey() -&gt; String {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return &quot;employee&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This way, when SyncKit synchronizes your objects it will set the <code>parent</code> property correctly, so that when you share a <code>Company</code> object with another user the share will include that company&#x27;s employees and employee addresses.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="updating-existing-records"></a>Updating existing records<a class="hash-link" href="#updating-existing-records" title="Direct link to heading">#</a></h2><p>If you specify the <code>parentKey</code> as mentioned above SyncKit will configure correctly the record hierarchy for new records being uploaded, but you might want to update existing records before using sharing functions â€“if you were using an older version of SyncKit and want to share an object that had been synchronized already, for example. It is possible to do so by doing:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">synchronizer.reuploadRecordsForChildrenOf(root: yourRootObject) { error in</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if error == nil {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // All records for the root object and its children updated with correct `parent` values</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sharing-objects-with-synckit"></a>Sharing objects with SyncKit<a class="hash-link" href="#sharing-objects-with-synckit" title="Direct link to heading">#</a></h2><p>You can prepare a <code>CKShare</code> like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Create CKShare and upload records to CloudKit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">strongSelf.synchronizer.share(object: object,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              publicPermission: .readOnly,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              participants: [],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              completion: { (share, error) in                            </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        })</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will create the share object and upload the object&#x27;s record and share to CloudKit. Depending on your application this might be all you need to do, or you could pass this share object to a <code>UICloudSharingController</code> to provide some UI for customization.</p><p>To stop sharing, use:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Delete share on CloudKit and remove local data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">strongSelf.synchronizer.removeShare(object: object,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  completion: { (error) in                            </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                        ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    })</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To update the local copy of a share, or remove it (in response to changes made by a <code>UICloudSharingController</code>, for example) use these:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">func cloudSharingControllerDidSaveShare(_ csc: UICloudSharingController) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    guard let share = csc.share else {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    synchronizer.cloudSharingControllerDidSaveShare(share, for: self.editigObject)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">func cloudSharingControllerDidStopSharing(_ csc: UICloudSharingController) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    synchronizer.cloudSharingControllerDidStopSharing(for: self.editingObject)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="accepting-shares"></a>Accepting shares<a class="hash-link" href="#accepting-shares" title="Direct link to heading">#</a></h2><p>Once a share has been created and sent to a user your UIApplicationDelegate class must be able to accept that share:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">func application(_ application: UIApplication, userDidAcceptCloudKitShareWith cloudKitShareMetadata: CKShareMetadata) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        let container = CKContainer(identifier: cloudKitShareMetadata.containerIdentifier)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        let acceptSharesOperation = CKAcceptSharesOperation(shareMetadatas: [cloudKitShareMetadata])</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        acceptSharesOperation.qualityOfService = .userInteractive</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        acceptSharesOperation.acceptSharesCompletionBlock = { error in</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if let error = error {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                DispatchQueue.main.async {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    let alertController = UIAlertController(title: &quot;Error&quot;, message: &quot;Could not accept CloudKit share: \(error.localizedDescription)&quot;, preferredStyle: .alert)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    alertController.addAction(UIAlertAction(title: &quot;OK&quot;, style: .default, handler: nil))</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            } else {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // Ready to synchronize</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        container.add(acceptSharesOperation)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>At that point the share has been accepted and records can be downloaded from the container&#x27;s shared database. You can use a synchronizer to do this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var sharedSynchronizer: CloudKitSynchronizer! = CloudKitSynchronizer.sharedSynchronizer(containerName: &quot;your-container-name&quot;, configuration: self.realmConfiguration)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sharedSynchronizer.synchronize { error in </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>When user A accepts a share from user B a new record zone is created in user A&#x27;s shared database for user B&#x27;s records. As a result, multiple record zones could be created in the shared database. Each time a <code>CloudKitSynchronizer</code> encounters a new record zone it will ask its <code>CloudKitSynchronizerAdapterProvider</code> for a <code>ModelAdapter</code> to handle changes in that record zone. The default provider will create a new Core Data stack or Realm for the record zone, as well as a model adapter. Therefore, one option to access this shared data would be to access each data stack through the synchronizer&#x27;s adapters (see <a href="/SyncKit/architecture">Architecture</a>)</p><p>To make this easier, you can configure a results controller that will surface data obtained from the shared database and will update the results when data gets synchronized. In the case of Core Data, there&#x27;s <code>CoreDataMultiFetchedResultsController</code> to provide an array of <code>NSFetchedResultsController</code>, and in the case of Realm there&#x27;s <code>MultiRealmResultsController</code> to provide an array of <code>Results&lt;T&gt;</code> (RealmSwift) or <code>RLMResults</code> (Realm)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Core Data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">let fetchRequest = NSFetchRequest&lt;NSFetchRequestResult&gt;(entityName: &quot;QSCompany&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">fetchRequest.sortDescriptors = [NSSortDescriptor(key: &quot;name&quot;, ascending: true)]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">let fetchedResultsController = synchronizer.multiFetchedResultsController(fetchRequest: fetchRequest)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">fetchedResultsController.delegate = self</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Delegate</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">func multiFetchedResultsControllerDidChangeControllers(_ controller: CoreDataMultiFetchedResultsController) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // reload data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">func controllerDidChangeContent(_ controller: NSFetchedResultsController&lt;NSFetchRequestResult&gt;) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // reload data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Realm</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resultsController = synchronizer.multiRealmResultsController()</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resultsController.didChangeRealms = { [weak self] controller in</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self?.tableView.reloadData()</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="shares"></a>Shares<a class="hash-link" href="#shares" title="Direct link to heading">#</a></h2><p>For existing objects you can check if they have been shared by calling</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@objc func share(for object: AnyObject) -&gt; CKShare?</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>CloudKitSynchronizer</code> will check the model adapter that manages that object and return the share if it exists. You then can present it using a <code>UICloudSharingController</code>, for example.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="record-zone-sharing"></a>Record Zone sharing<a class="hash-link" href="#record-zone-sharing" title="Direct link to heading">#</a></h2><p>On iOS 15 or OSX 12, CloudKit also supports sharing a whole <a href="https://developer.apple.com/documentation/cloudkit/ckshare/3746825-init?language=swift" target="_blank" rel="noopener noreferrer">record zone</a>, making it easier to share any number of records in that zone without having to establish a parent-child relationship between them.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sharing-a-record-zone-with-synckit"></a>Sharing a Record Zone with SyncKit<a class="hash-link" href="#sharing-a-record-zone-with-synckit" title="Direct link to heading">#</a></h3><p>Similar to how objects are shared, you can can prepare a <code>CKShare</code> like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Create CKShare and upload records to CloudKit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">strongSelf.synchronizer.share(forRecordZoneID: zoneID,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              publicPermission: .readOnly,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              participants: [],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              completion: { (share, error) in                            </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        })</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will create the share object and upload it to CloudKit. Depending on your application this might be all you need to do, or you could pass this share object to a <code>UICloudSharingController</code> to provide some UI for customization.</p><p>To stop sharing, use:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Delete share on CloudKit and remove local data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">strongSelf.synchronizer.removeShare(forRecordZoneID: zoneID,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  completion: { (error) in                            </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                        ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    })</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To update the local copy of a share, or remove it (in response to changes made by a <code>UICloudSharingController</code>, for example) use these:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">func cloudSharingControllerDidSaveShare(_ csc: UICloudSharingController) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    guard let share = csc.share else {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    synchronizer.cloudSharingControllerDidSaveShare(share, forRecordZoneID: theRecordZoneID)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">func cloudSharingControllerDidStopSharing(_ csc: UICloudSharingController) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    synchronizer.cloudSharingControllerDidStopSharing(forRecordZoneID: theRecordZoneID)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The process to accept a share and synchronize the new record zone is then the same as for regular shares. (See <a href="/SyncKit/sharing#accepting-shares">Accepting shares</a>)</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/SyncKit/configuration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Configuration</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/SyncKit/architecture"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Architecture Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements" class="table-of-contents__link">Requirements</a></li><li><a href="#configuring-records-for-sharing" class="table-of-contents__link">Configuring records for sharing</a></li><li><a href="#updating-existing-records" class="table-of-contents__link">Updating existing records</a></li><li><a href="#sharing-objects-with-synckit" class="table-of-contents__link">Sharing objects with SyncKit</a></li><li><a href="#accepting-shares" class="table-of-contents__link">Accepting shares</a></li><li><a href="#shares" class="table-of-contents__link">Shares</a></li><li><a href="#record-zone-sharing" class="table-of-contents__link">Record Zone sharing</a><ul><li><a href="#sharing-a-record-zone-with-synckit" class="table-of-contents__link">Sharing a Record Zone with SyncKit</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/SyncKit/">Getting Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">Support</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/mentrena/SyncKit/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Report a bug on Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/mentrena/SyncKit" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 SyncKit. Built with Docusaurus.</div></div></div></footer></div>
<script src="/SyncKit/assets/js/runtime~main.0680bf2b.js"></script>
<script src="/SyncKit/assets/js/main.41bd0433.js"></script>
</body>
</html>